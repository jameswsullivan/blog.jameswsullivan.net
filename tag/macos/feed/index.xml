<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>macOS &#8211; howdy</title>
	<atom:link href="https://jameswsullivan.github.io/tag/macos/feed/" rel="self" type="application/rss+xml" />
	<link>https://jameswsullivan.github.io/</link>
	<description></description>
	<lastBuildDate>Sun, 19 Nov 2023 20:12:33 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.4.1</generator>
	<item>
		<title>Refurbish Mac Mini A1347 (Late 2014 and Mid 2011) &#8211; Part 4</title>
		<link>https://jameswsullivan.github.io/refurbish-mac-mini-a1347-late-2014-and-mid-2011-part-4/</link>
		
		<dc:creator><![CDATA[James]]></dc:creator>
		<pubDate>Sun, 19 Nov 2023 18:29:10 +0000</pubDate>
				<category><![CDATA[blog]]></category>
		<category><![CDATA[Driver]]></category>
		<category><![CDATA[Electronics]]></category>
		<category><![CDATA[Hardware]]></category>
		<category><![CDATA[Mac Mini]]></category>
		<category><![CDATA[Mac Mini A1347]]></category>
		<category><![CDATA[macOS]]></category>
		<category><![CDATA[Repair]]></category>
		<category><![CDATA[Windows Systems Administration]]></category>
		<guid isPermaLink="false">https://jameswsullivan.github.io/?p=2827</guid>

					<description><![CDATA[Refurbish Mac Mini A1347 (Late 2014 and Mid 2011) - Part 4. Restore Mac Mini late-2014 and mid-2011. Install Windows 10 on Mac Mini mid-2011 (macmini5,1).]]></description>
										<content:encoded><![CDATA[
<h2 class="wp-block-heading" id="0-background">Background:</h2>



<p>I came across two more cheap Mac Mini A1347 (one is late-2014 the other is a mid-2011) that I can use for my projects. While restoring them, I came across a few things that&#8217;s worth noting.</p>



<h2 class="wp-block-heading">Issues:</h2>



<ol>
<li>The mid-2011 model has great difficulty with drivers (particularly display and sound) with Windows 10/11.</li>



<li>The mid-2011 model gets very hot when just under normal workload.</li>



<li>The late-2014 model automatically turns on after applying power (which is something I want to disable).</li>



<li>Install 16GB RAM and a second hard drive to the mid-2011 model.</li>
</ol>



<h2 class="wp-block-heading" id="1-issues">Solutions:</h2>



<p>1. The mid-2011 model has great difficulty with drivers (particularly display and sound) with Windows 10/11.</p>



<p>The mid-2011 model (<a href="https://support.apple.com/kb/sp632?locale=en_US" target="_blank" rel="noreferrer noopener">the 2.3Ghz variant</a>) has the Intel HD 3000 graphics card and the Cirrus Audio CS4206B sound card, both of which don&#8217;t have official driver support for anything beyond Windows 7. Plus, if Windows is installed using EFI, the screen is going to go black as soon as HD 3000&#8217;s display driver gets applied, and installing the Cirrus Audio driver will not work either. While you can force Windows to use the Basic Display Driver (Microsoft Basic Display Adapter) by uninstalling the display driver using <a href="https://www.wagnardsoft.com/display-driver-uninstaller-DDU-" target="_blank" rel="noreferrer noopener">DDU</a> and blocking the Hardware Ids using Group Policy (will explain in the last section of this post), it&#8217;s not an elegant solution after all and you&#8217;ll still suffer from no audio (from both HDMI and Cirrus Audio).</p>



<blockquote class="wp-block-quote">
<p>According to some research, it seems that there might be a solution by using DSDT modification/override so that the hardware can be properly &#8220;seen&#8221; and handled correctly by the OS under UEFI. But it&#8217;s not worth it for me to go down that rabbit hole to figure it out, so I just opted for Legacy BIOS mode (which also means that Windows 11 is not the best option). </p>
</blockquote>



<p>After installing Windows 10 using Legacy BIOS mode, everything works fine except the Display-Audio via HDMI despite the fact that all drivers have been installed and are showing that they work &#8220;correctly&#8221; in Device Manager. There is nothing indicating errors but HDMI and Thunderbolt ports both output no sound to the TV. But it&#8217;s acceptable in my case to use as a &#8220;media player&#8221; for my treadmill, which accepts a 3.5mm audio input to the treadmill&#8217;s speakers.</p>



<p>Download:</p>



<ul>
<li><a href="https://github.com/jameswsullivan/blog-file-share/blob/main/Macmini5%2C1-Drivers.7z">Windows 10 drivers for Mac Mini mid-2011 (Macmini5,1)</a></li>



<li><a href="https://www.wagnardsoft.com/display-driver-uninstaller-DDU-">DDU (Display Driver Uninstaller)</a> (<a href="https://www.intel.com/content/www/us/en/support/articles/000091878/graphics.html" target="_blank" rel="noreferrer noopener">reference</a>)</li>
</ul>



<p>Additionally, <a href="https://www.intel.com/content/www/us/en/support/articles/000090440/graphics.html" target="_blank" rel="noreferrer noopener">Intel HD 4000&#8217;s driver</a> seems to also work for Intel HD 3000, and its Display Audio driver is a newer version which supports &#8220;Windows 10&#8221;, but I still wasn&#8217;t able to get sound from HDMI/Thunderbolt.</p>



<p>2. The mid-2011 model gets very hot when just under normal workload.</p>



<p>I guess this was somewhat &#8220;by design&#8221; because I&#8217;ve done my due diligence to check, clean, and restore everything I can think of &#8211; heatsink, thermal paste, fan, etc.. It&#8217;s been restored to a condition that&#8217;s almost like new. After some Googling around I think it&#8217;s just how this particular model is, because the aluminum case is designed to act as a &#8220;heatsink&#8221; to dissipate heat, I guess I&#8217;m just used to newer model&#8217;s cooler and quieter designs.</p>



<p>3. The late-2014 model automatically turns on after applying power (which is something I want to disable).</p>



<p>One of the late-2014 models automatically turns on after applying power, and judging from what was originally installed on it, it seems to be used as a display device at a medical facility that runs a 24/7 slideshow. Disabling it was easy:</p>



<p>Get into Recovery Mode by <code>Option/Windows Key + R</code> , and open <strong>Terminal</strong> under <strong>Utilities</strong>, and type the following command:</p>



<pre class="wp-block-code"><code># To disable:
pmset autorestart 0

# If you want to enable "Power On After Power-Loss", set the value to 1 instead.
pmset autorestart 1</code></pre>



<p>4. Install 16GB RAM and a second hard drive to the mid-2011 model.</p>



<p>RAM and a second hard drive are one of the most popular upgrades done on this model, <a href="https://www.ifixit.com/Device/Mac_Mini_Mid_2011" target="_blank" rel="noreferrer noopener">ifixit has very well made instructions</a>.</p>



<div style="height:50px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Forcing Windows 11 (in UEFI mode) to use Microsoft Basic Display Adapter without automatically installing drivers.</h2>



<p>Find the &#8220;Hardware Ids&#8221;:</p>



<pre class="wp-block-code"><code>Device Manager -- Display adapters -- Properties -- Details tab -- Select "Hardware Ids" from the Property drop-down -- Copy them to a text file.</code></pre>



<p>Block them using Group Policy:</p>



<pre class="wp-block-code"><code>Open Local Group Policy Editor, go to Computer Configuration -- Administrative Templates -- System -- Device Installation -- Device Installation Restrictions -- "Prevent installation of devices that match any of these device IDs."

Enable it and add the Hardware Ids you found from Device Manager.</code></pre>



<p>Additionally, you can configure the following to stop Windows 11 from automatically updating drivers:</p>



<pre class="wp-block-code"><code>Open Local Group Policy Editor, go to Computer Configuration -- Administrative Templates -- Windows Components -- Windows Update -- Manage Updates offered from Windows Update -- Enable “Do not include drivers with Windows Updates”</code></pre>



<pre class="wp-block-code"><code>Open Settings -- System -- About -- Advanced system settings -- Hardware tab -- Device Installation Settings -- Check "No (your device might not work as expected)"</code></pre>



<p>During the process, if the screen goes black after Windows 11 automatically applies a display driver (Intel HD 3000 in this case), you might need to get into Safe Mode to use <a href="https://www.wagnardsoft.com/display-driver-uninstaller-DDU-" target="_blank" rel="noreferrer noopener">DDU</a> to remove the driver. You can force powering off the machine three times to get into Advanced boot options (Recovery) mode, or you can try the following trick (because the OS is not frozen or dead, it&#8217;s just the screen that&#8217;s gone black, so you can still do things &#8220;blindly&#8221;):</p>



<pre class="wp-block-code"><code>Windows + R (Run) -- type "shutdown /r /o /t /f 0"</code></pre>



<p>Assuming there is nothing else blocking the reboot, it should go to the Advanced boot options menu upon restart.</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>Refurbish Mac Mini A1347 (Late 2014 ) – Part 2 &#8211; Install Windows 11</title>
		<link>https://jameswsullivan.github.io/refurbish-mac-mini-a1347-late-2014-part-2-install-windows-11/</link>
		
		<dc:creator><![CDATA[James]]></dc:creator>
		<pubDate>Sun, 01 Oct 2023 21:04:59 +0000</pubDate>
				<category><![CDATA[blog]]></category>
		<category><![CDATA[brigadier]]></category>
		<category><![CDATA[Mac Mini]]></category>
		<category><![CDATA[Mac Mini A1347]]></category>
		<category><![CDATA[macOS]]></category>
		<category><![CDATA[System Administration]]></category>
		<category><![CDATA[Windows Systems Administration]]></category>
		<guid isPermaLink="false">https://jameswsullivan.github.io/?p=2797</guid>

					<description><![CDATA[Refurbish Mac Mini A1347 (late 2014, EMC 2840, 820-5509-A) - Part 2 - Install Windows 11 natively.]]></description>
										<content:encoded><![CDATA[
<h2 class="wp-block-heading">Background:</h2>



<p>As detailed in <a href="https://jameswsullivan.github.io/refurbish-mac-mini-a1347-late-2014-part-1/">the previous article</a>, after the Mac Minis were restored (hardware wise), I decided to use one of them as a &#8220;media player&#8221; and mount it on the back of a monitor and place it in front of the treadmill to use while I work out. And since it&#8217;ll only be used as a media player, installing Windows 11 on it won&#8217;t be a bad idea.</p>



<p>I didn&#8217;t use BootCamp and didn&#8217;t have macOS and Windows dual OS, Windows 11 was installed natively. However, without going through the BootCamp process means that the Windows drivers issue won&#8217;t be automatically resolved.</p>



<h2 class="wp-block-heading">Solution:</h2>



<p>After installing Windows 11, use <a href="https://github.com/timsutton/brigadier">Brigadier</a> to download and install BootCamp and drivers, after the drivers are successfully installed, BootCamp and other Apple related software can be safely removed.</p>



<p>Currently there is <a href="https://github.com/timsutton/brigadier/issues/37">a 7zip issue</a> (<a href="https://sourceforge.net/p/sevenzip/bugs/2414/">7zip bug</a>) when unpacking the payload with brigadier. The easiest way to avoid this issue is to install the <code>7-Zip 22.01 (2022-07-15)</code> version.</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>Refurbish Mac Mini A1347 (Late 2014 ) &#8211; Part 1</title>
		<link>https://jameswsullivan.github.io/refurbish-mac-mini-a1347-late-2014-part-1/</link>
		
		<dc:creator><![CDATA[James]]></dc:creator>
		<pubDate>Sun, 01 Oct 2023 20:21:14 +0000</pubDate>
				<category><![CDATA[blog]]></category>
		<category><![CDATA[Mac Mini]]></category>
		<category><![CDATA[Mac Mini A1347]]></category>
		<category><![CDATA[macOS]]></category>
		<guid isPermaLink="false">https://jameswsullivan.github.io/?p=2784</guid>

					<description><![CDATA[Refurbish Mac Mini A1347 (late 2014, EMC 2840, 820-5509-A) - Part 1.]]></description>
										<content:encoded><![CDATA[
<h2 class="wp-block-heading">Background:</h2>



<p>I&#8217;ve acquired a few Mac Mini A1347 (late 2014, EMC 2840, 820-5509-A) over the years for my projects due to their decent performance, low price, and the possibility of RAM and SSD upgrades (RAM upgrade will require soldering/de-soldering of the memory chips and reconfiguration of some resistors, which I&#8217;ll attempt at a later time). This first part of the series details the process of how I resolved the overheating issue and some OS installation hiccups.</p>



<p>Machines and their specs:</p>



<ul>
<li>2 x i5, 4GB RAM models, with no HDD/SSD and accessories.</li>



<li>1 x i5, 8GB RAM model, with original 1TB HDD.</li>
</ul>



<h2 class="wp-block-heading">Problems:</h2>



<ol>
<li>One 4GB model repeatedly gets the 5101F error when attempting to reinstall macOS via Internet Recovery. Also, for some reason this particular machine would not enter its built-in Recovery Mode regardless which key combinations were used (<code>Command/Windows Key + R</code> should enter built-in Recovery Mode, <code>Command/Windows Key + Option/Alt + R</code> enters Internet Recovery), it would always automatically enter Internet Recovery and eventually fails with the 5101F error.</li>



<li>The 8GB RAM model produces excessive heat compared to the rest of Mac Minis and received the &#8220;An error occurred while preparing the installation. try running this application again.&#8221; error while reinstalling macOS Sierra via built-in Recovery Mode.</li>
</ol>



<h2 class="wp-block-heading">Solution:</h2>



<p><strong>1. The 5101F and unable to enter built-in Recovery Mode problem:</strong></p>



<p>This error could have multiple causes (such as poor internet connection). In my case, resetting the PRAM/NVRAM resolved it. To reset the PRAM/NVRAM, follow these steps:</p>



<ul>
<li>Power off the Mac Mini.</li>



<li>Power on the machine, press and hold <code>Option + Command + P + R (Windows Key + Alt + P + R)</code> when you hear the power-on chime. The machine will restart a few times, keep holding the keys until you hear the third chime (counting from the one when you first powered the machine on).</li>



<li>Release the keys, your machine will reboot one more time and then boot normally.</li>
</ul>



<p>Note: you can also hold the keys for 20+ seconds. The number of chimes you hear is not a factor as to whether the reset is successful.</p>



<p>After the NVRAM reset, shut down the machine, unplug the power cord, push and hold the power button for a few seconds and then power on the machine and use <code>Command/Windows Key + R</code> to enter built-in Recovery Mode.</p>



<p>Upon successful boot up, I discovered that the OS Recovery was still at Yosemite (the other 4GB model was at Sierra). Without knowing the history of the machine, maybe being outdated had something to do with the errors.</p>



<p>After reinstalling macOS Yosemite, macOS Sierra can be downloaded <a href="https://support.apple.com/en-us/HT211683#browser">here</a> and manually installed without further issues (Internet Recovery still produces 5101F error).</p>



<p><strong>2. &#8220;An error occurred while preparing the installation. try running this application again.&#8221; while reinstalling macOS Sierra via built-in Recovery Mode.</strong></p>



<p>For this one, resetting the NVRAM had no effect, but going straight to Internet Recovery was able to install macOS Monterey successfully. It seems that the built-in OS Recovery for Sierra was broken in <a href="https://www.reddit.com/r/MacOS/comments/1030a4g/need_help_with_this_an_error_occurred_while/">some cases</a>.</p>



<p><strong>3. The excessive heat.</strong></p>



<p>Assuming that the cooling fan and logic boards are all clean and intact and there is no excessive dust that blocks the cooling channels, reapplying the thermal paste on the CPU is usually the solution. I assume that if you&#8217;re already doing this level of repair, you would already be familiar with how to disassemble the Mac Mini and the heatsink, so I&#8217;ll only post a few pictures here for reference.</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-1 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-scaled.jpg"><img fetchpriority="high" decoding="async" width="1024" height="576" data-id="2788" src="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-1024x576.jpg" alt="" class="wp-image-2788" srcset="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-1024x576.jpg 1024w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-300x169.jpg 300w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-768x432.jpg 768w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-1536x864.jpg 1536w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-2048x1152.jpg 2048w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-01-700x394.jpg 700w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<figure class="wp-block-image size-large"><a href="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-scaled.jpg"><img decoding="async" width="1024" height="576" data-id="2789" src="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-1024x576.jpg" alt="" class="wp-image-2789" srcset="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-1024x576.jpg 1024w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-300x169.jpg 300w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-768x432.jpg 768w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-1536x864.jpg 1536w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-2048x1152.jpg 2048w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-02-700x394.jpg 700w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<figure class="wp-block-image size-large"><a href="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-scaled.jpg"><img decoding="async" width="1024" height="575" data-id="2790" src="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-1024x575.jpg" alt="" class="wp-image-2790" srcset="https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-1024x575.jpg 1024w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-300x169.jpg 300w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-768x432.jpg 768w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-1536x863.jpg 1536w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-2048x1151.jpg 2048w, https://jameswsullivan.github.io/wp-content/uploads/2023/10/macmini-thermal-paste-03-700x393.jpg 700w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>
</figure>
]]></content:encoded>
					
		
		
			</item>
	</channel>
</rss>
